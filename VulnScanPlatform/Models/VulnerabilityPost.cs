namespace VulnScanPlatform.Models
{
    public class VulnerabilityPost
    {
        public int Id { get; set; }
        public string Title { get; set; }
        public string Description { get; set; }
        public string HtmlContent { get; set; } // Conținutul HTML scanat
        public string VulnerabilitiesJson { get; set; } // JSON cu vulnerabilitățile detectate
        public int VulnerabilityCount { get; set; }
        public int CriticalCount { get; set; }
        public int HighCount { get; set; }
        public int MediumCount { get; set; }
        public int LowCount { get; set; }
        public string PostedByUserId { get; set; }
        public DateTime PostedAt { get; set; } = DateTime.UtcNow;
        public int UpvoteCount { get; set; } = 0;
        public bool IsApproved { get; set; } = true; // Pentru moderare viitoare

        // Navigation properties
        public User PostedBy { get; set; }
        public List<VulnerabilityPostVote> Votes { get; set; } = new();
        public int? ScanId { get; set; }
        public Scan Scan { get; set; }
    }

    public class VulnerabilityPostVote
    {
        public int Id { get; set; }
        public int PostId { get; set; }
        public string UserId { get; set; }
        public DateTime VotedAt { get; set; } = DateTime.UtcNow;

        // Navigation properties
        public VulnerabilityPost Post { get; set; }
        public User User { get; set; }
    }
}